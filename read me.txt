All the code was taken from this book https://www.labirint.ru/books/753859/